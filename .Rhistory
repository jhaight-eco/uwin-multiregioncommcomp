data_muphi0 <- data.frame(
"species" = data.spp$Species,
"species_code" = data.spp$species_code,
"common_name" = data.spp$name_common,
"mass_kg" = data.spp$mass/1000,
"logmass" = data.spp$logmass,
"logmass_std" = data.spp$logmass.std,
"carnivory" = data.spp$carn*100,
"carnivory_std" = data.spp$carn.std,
"muphi0" = c(t(cri[1,])),
"muphi0_lower95" = c(t(cri[2,])),
"muphi0_upper95" = c(t(cri[3,]))
)
###### Plot Occupancy vs. Species Traits ====
# drop the species that weren't very well detected from the plot
data.plot.spp <- data_muphi0 %>%
filter(!species %in% c("black_bear", "cougar", "flying_squirrel_sp", "hooded_skunk", "mountain beaver","north_american_beaver", "richardson_ground_squirrel", "weasel_sp"))
# Body Mass
plot.mass1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = logmass, y = bm_med, ymin = bm_lower95, ymax = bm_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = logmass, y = bm_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = logmass, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95),
color = "grey30") +
labs(x = "Body Mass (kg)", y = "Species Occupancy") +
scale_x_continuous(trans = "log10", breaks = log10(c(0.1, 1, 10, 100, 500)*1000), labels = c("0.1","1", "10", "100","500")) +
#coord.cartesian(xlim=c(1,6), ylim=c(0, 0.6))+
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
plot.mass1
ggsave("./figures/extendeddata_figure2a_speciesoccupancy_vs_mass.png",
plot.mass1,
width = 4,
height = 6,
units = "in",
dpi = 300)
# Carnivory
plot.carn1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = carnivory, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = carnivory, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Species Occupancy") +
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
legend.position = "none",
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
plot.carn1
ggsave("./figures/extendeddata_figure2b_speciesoccupancy_vs_carnivory.png",
plot.carn1,
width = 4,
height = 6,
units = "in",
dpi = 300)
# sequences of hypothetical trait values to predict off of
seq.bm <- seq(min(data.spp$logmass.std), max(data.spp$logmass.std), length.out = npred)
seq.ca <- seq(min(data.spp$carn.std), max(data.spp$carn.std), length.out = npred)
plot.bm <- seq(min(data.spp$logmass), max(data.spp$logmass), length.out = npred)
plot.ca <- seq(min(data.spp$carn), max(data.spp$carn), length.out = npred)
range(plot.bm)
range(plot.ca)
# Create a design matrix based on the equation: 1 = intercept, my.seq = trail values to predict off of
dm.bm <- cbind(1, seq.bm, 0)
dm.ca <- cbind(1, 0, seq.ca)
# Grab the appropriate slope parameters
mcmc.traits <- cbind(tmp$mu.beta1.s1, tmp$delta2.spp1, tmp$delta2.spp2)
# Some quick matrix math, multiplying the design matrix by the mcmc slope parameters
pred.bm <- mcmc.traits %*% t(dm.bm)
pred.ca <- mcmc.traits %*% t(dm.ca)
# Summarize the predictions. We really only need the median and CRIs
pred.bm <- apply(pred.bm, 2, quantile, probs = c(0.025, 0.5, 0.975))
pred.ca <- apply(pred.ca, 2, quantile, probs = c(0.025, 0.5, 0.975))
# organize for plotting using ggplot
(data.pred.urbocc <- data.frame(
"logmass_std" = seq.bm,
"logmass" = plot.bm,
"carnivory_std" = seq.ca,
"carnivory" = plot.ca,
t(pred.bm),
t(pred.ca)
))
colnames(data.pred.urbocc)[5:10] <- c("bm_lower95", "bm_med", "bm_upper95",
"ca_lower95", "ca_med", "ca_upper95")
###### Extract distributions of each species' response to within-city covariates ######
# community-level effects
pred.beta1 <- tmp$mu.beta1.s1
pred.beta2 <- tmp$mu.beta2.s2
pred.beta3 <- tmp$mu.beta3.s3
# species-level effects (city-averages)
pred.phi1 <- array(NA, dim = c(nsamp, 37)) # blank arrays for storing the data
pred.phi2 <- array(NA, dim = c(nsamp, 37))
pred.phi3 <- array(NA, dim = c(nsamp, 37))
for(i in 1:nsamp){
for(k in 1:37){
pred.phi1[i,k] <- tmp$mu.phi1.s1[i,k]
pred.phi2[i,k] <- tmp$mu.phi2.s2[i,k]
pred.phi3[i,k] <- tmp$mu.phi3.s3[i,k]
}
}
# Summarize each, getting posterior means and credible intervals (90% and 95%)
pm1 <- apply(pred.phi1, c(2), function(x)   mean(x, na.rm=TRUE))
pmed1 <- apply(pred.phi1, c(2), function(x)   mean(x, na.rm=TRUE))
cri1 <- apply(pred.phi1, c(2), function(x)   quantile(x, prob = c(0.025, 0.975, 0.05, 0.95)))
pm2 <- apply(pred.phi2, c(2), function(x)   mean(x, na.rm=TRUE))
pmed2 <- apply(pred.phi2, c(2), function(x)   mean(x, na.rm=TRUE))
cri2 <- apply(pred.phi2, c(2), function(x)   quantile(x, prob = c(0.025, 0.975, 0.05, 0.95)))
pm3 <- apply(pred.phi3, c(2), function(x)   mean(x, na.rm=TRUE))
pmed3 <- apply(pred.phi3, c(2), function(x)   mean(x, na.rm=TRUE))
cri3 <- apply(pred.phi3, c(2), function(x)   quantile(x, prob = c(0.025, 0.975, 0.05, 0.95)))
data_phi1_3 <- data.frame(
"species" = data.spp$Species,
"species_code" = data.spp$species_code,
"common_name" = data.spp$name_common,
"phi1" = pmed1,
"phi1_lower95" = c(t(cri1[3,])),
"phi1_upper95" = c(t(cri1[4,])),
"phi2" = pmed2,
"phi2_lower95" = c(t(cri2[3,])),
"phi2_upper95" = c(t(cri2[4,])),
"phi3" = pmed3,
"phi3_lower95" = c(t(cri3[3,])),
"phi3_upper95" = c(t(cri3[4,])),
"mass" = data.spp$mass/1000,
"logmass" = data.spp$logmass,
"carnivory" = data.spp$carn*100,   # put carnivory as a percentage
"carn_std" = data.spp$carn.std
)
# Orders of increasing body mass and carnivory, for plotting purposes
data_phi1_3 <- data_phi1_3 %>% arrange(logmass)
data_phi1_3$order_mass <- as.factor(c(1:nrow(data_phi1_3)))
data_phi1_3 <- data_phi1_3 %>% arrange(carnivory,logmass)
data_phi1_3$order.carn <- as.factor(c(1:nrow(data_phi1_3)))
data_phi1_3$fact.carn <- as.factor(round(data_phi1_3 %>% pull(carnivory), digits = 2))
data_phi1_3 <- data_phi1_3 %>% arrange(species)
###### Plot Urbanization-Occupancy Relationships vs. Traits ######
# Body Mass
# drop the rarely detected species and sort by mass
data.plot.spp <- data_phi1_3 %>%
arrange(mass) %>%
filter(!species %in% c("black_bear", "cougar", "flying_squirrel_sp", "hooded_skunk", "mountain beaver","north_american_beaver", "richardson_ground_squirrel", "weasel_sp")) # exclude rarely detected species from plot
plot.mass2 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.urbocc, aes(x = logmass, y = bm_med, ymin = bm_lower95, ymax = bm_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.urbocc, aes(x = logmass, y = bm_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = logmass, y = phi1, ymin = phi1_lower95, ymax = phi1_upper95),
color = "grey30") +
labs(x = "Body Mass (kg)", y = "Occupancy-Urbanization \nRelationship") +
scale_x_continuous(trans = "log10", breaks = log10(c(0.1, 1, 10, 100, 500)*1000), labels = c("0.1","1", "10", "100","500")) +
theme(
#axis.text.x = element_blank(),
#axis.text.y = element_blank(),
#axis.ticks = element_blank(),
axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.mass2
ggsave("./figures/Figure3a_speciesurbanrelationship_vs_mass.png",
plot.mass2,
width = 4,
height = 6,
units = "in",
dpi = 300)
# Carnivory
# drop the rarely detected species and sort by carnivory
data.plot.spp <- data_phi1_3 %>%
arrange(mass) %>%
filter(!species %in% c("black_bear", "cougar", "flying_squirrel_sp", "hooded_skunk", "mountain beaver","north_american_beaver", "richardson_ground_squirrel", "weasel_sp")) # exclude rarely detected species from plot
plot.carn2 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.urbocc, aes(x = carnivory*100+0.001, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.urbocc, aes(x = carnivory*100+0.001, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory+0.001, y = phi1, ymin = phi1_lower95, ymax = phi1_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Occupancy-Urbanization \nRelationship") +
theme(
#axis.text.x = element_blank(),
#axis.text.y = element_blank(),
#axis.ticks = element_blank(),
legend.position = "none",
axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.carn2
ggsave("./figures/Figure3b_speciesurbanrelationship_vs_carnivory.png",
plot.mass2,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/extendeddata_figure2a_speciesoccupancy_vs_mass.png",
plot.mass1,
width = 6,
height = 4,
units = "in",
dpi = 300)
# Carnivory
plot.carn1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = carnivory, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = carnivory, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Species Occupancy") +
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
legend.position = "none",
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
# Carnivory
plot.carn1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = carnivory, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = carnivory, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Species Occupancy") +
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
legend.position = "none",
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
plot.carn1
ggsave("./figures/extendeddata_figure2b_speciesoccupancy_vs_carnivory.png",
plot.carn1,
width = 6,
height = 4,
units = "in",
dpi = 300)
# Carnivory
plot.carn1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = carnivory, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = carnivory, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Species Occupancy") +
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
legend.position = "none",
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
plot.carn1
data_muphi0 <- data.frame(
"species" = data.spp$Species,
"species_code" = data.spp$species_code,
"common_name" = data.spp$name_common,
"mass_kg" = data.spp$mass/1000,
"logmass" = data.spp$logmass,
"logmass_std" = data.spp$logmass.std,
"carnivory" = data.spp$carn*100,
"carnivory_std" = data.spp$carn.std,
"muphi0" = c(t(cri[1,])),
"muphi0_lower95" = c(t(cri[2,])),
"muphi0_upper95" = c(t(cri[3,]))
)
###### Plot Occupancy vs. Species Traits ====
# drop the species that weren't very well detected from the plot
data.plot.spp <- data_muphi0 %>%
filter(!species %in% c("black_bear", "cougar", "flying_squirrel_sp", "hooded_skunk", "mountain beaver","north_american_beaver", "richardson_ground_squirrel", "weasel_sp"))
# Body Mass
plot.mass1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = logmass, y = bm_med, ymin = bm_lower95, ymax = bm_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = logmass, y = bm_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = logmass, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95),
color = "grey30") +
labs(x = "Body Mass (kg)", y = "Species Occupancy") +
scale_x_continuous(trans = "log10", breaks = log10(c(0.1, 1, 10, 100, 500)*1000), labels = c("0.1","1", "10", "100","500")) +
#coord.cartesian(xlim=c(1,6), ylim=c(0, 0.6))+
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
plot.mass1
ggsave("./figures/extendeddata_figure2a_speciesoccupancy_vs_mass.png",
plot.mass1,
width = 6,
height = 4,
units = "in",
dpi = 300)
# Carnivory
plot.carn1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = carnivory, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = carnivory, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Species Occupancy") +
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
legend.position = "none",
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
plot.carn1
ggsave("./figures/extendeddata_figure2b_speciesoccupancy_vs_carnivory.png",
plot.carn1,
width = 6,
height = 4,
units = "in",
dpi = 300)
plot.mass1
ggsave("./figures/extendeddata_figure2a_speciesoccupancy_vs_mass.png",
plot.mass1,
width = 6,
height = 4,
units = "in",
dpi = 300)
# Carnivory
plot.carn1 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.occ, aes(x = carnivory, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.occ, aes(x = carnivory, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory, y = muphi0, ymin = muphi0_lower95, ymax = muphi0_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Species Occupancy") +
theme(axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
legend.position = "none",
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18),
)
plot.carn1
ggsave("./figures/extendeddata_figure2b_speciesoccupancy_vs_carnivory.png",
plot.carn1,
width = 6,
height = 4,
units = "in",
dpi = 300)
# sequences of hypothetical trait values to predict off of
seq.bm <- seq(min(data.spp$logmass.std), max(data.spp$logmass.std), length.out = npred)
seq.ca <- seq(min(data.spp$carn.std), max(data.spp$carn.std), length.out = npred)
plot.bm <- seq(min(data.spp$logmass), max(data.spp$logmass), length.out = npred)
plot.ca <- seq(min(data.spp$carn), max(data.spp$carn), length.out = npred)
range(plot.bm)
range(plot.ca)
# Create a design matrix based on the equation: 1 = intercept, my.seq = trail values to predict off of
dm.bm <- cbind(1, seq.bm, 0)
dm.ca <- cbind(1, 0, seq.ca)
# Grab the appropriate slope parameters
mcmc.traits <- cbind(tmp$mu.beta1.s1, tmp$delta2.spp1, tmp$delta2.spp2)
# Some quick matrix math, multiplying the design matrix by the mcmc slope parameters
pred.bm <- mcmc.traits %*% t(dm.bm)
pred.ca <- mcmc.traits %*% t(dm.ca)
# Summarize the predictions. We really only need the median and CRIs
pred.bm <- apply(pred.bm, 2, quantile, probs = c(0.025, 0.5, 0.975))
pred.ca <- apply(pred.ca, 2, quantile, probs = c(0.025, 0.5, 0.975))
# organize for plotting using ggplot
(data.pred.urbocc <- data.frame(
"logmass_std" = seq.bm,
"logmass" = plot.bm,
"carnivory_std" = seq.ca,
"carnivory" = plot.ca,
t(pred.bm),
t(pred.ca)
))
colnames(data.pred.urbocc)[5:10] <- c("bm_lower95", "bm_med", "bm_upper95",
"ca_lower95", "ca_med", "ca_upper95")
###### Extract distributions of each species' response to within-city covariates ######
# community-level effects
pred.beta1 <- tmp$mu.beta1.s1
pred.beta2 <- tmp$mu.beta2.s2
pred.beta3 <- tmp$mu.beta3.s3
# species-level effects (city-averages)
pred.phi1 <- array(NA, dim = c(nsamp, 37)) # blank arrays for storing the data
pred.phi2 <- array(NA, dim = c(nsamp, 37))
pred.phi3 <- array(NA, dim = c(nsamp, 37))
for(i in 1:nsamp){
for(k in 1:37){
pred.phi1[i,k] <- tmp$mu.phi1.s1[i,k]
pred.phi2[i,k] <- tmp$mu.phi2.s2[i,k]
pred.phi3[i,k] <- tmp$mu.phi3.s3[i,k]
}
}
# Summarize each, getting posterior means and credible intervals (90% and 95%)
pm1 <- apply(pred.phi1, c(2), function(x)   mean(x, na.rm=TRUE))
pmed1 <- apply(pred.phi1, c(2), function(x)   mean(x, na.rm=TRUE))
cri1 <- apply(pred.phi1, c(2), function(x)   quantile(x, prob = c(0.025, 0.975, 0.05, 0.95)))
pm2 <- apply(pred.phi2, c(2), function(x)   mean(x, na.rm=TRUE))
pmed2 <- apply(pred.phi2, c(2), function(x)   mean(x, na.rm=TRUE))
cri2 <- apply(pred.phi2, c(2), function(x)   quantile(x, prob = c(0.025, 0.975, 0.05, 0.95)))
pm3 <- apply(pred.phi3, c(2), function(x)   mean(x, na.rm=TRUE))
pmed3 <- apply(pred.phi3, c(2), function(x)   mean(x, na.rm=TRUE))
cri3 <- apply(pred.phi3, c(2), function(x)   quantile(x, prob = c(0.025, 0.975, 0.05, 0.95)))
data_phi1_3 <- data.frame(
"species" = data.spp$Species,
"species_code" = data.spp$species_code,
"common_name" = data.spp$name_common,
"phi1" = pmed1,
"phi1_lower95" = c(t(cri1[3,])),
"phi1_upper95" = c(t(cri1[4,])),
"phi2" = pmed2,
"phi2_lower95" = c(t(cri2[3,])),
"phi2_upper95" = c(t(cri2[4,])),
"phi3" = pmed3,
"phi3_lower95" = c(t(cri3[3,])),
"phi3_upper95" = c(t(cri3[4,])),
"mass" = data.spp$mass/1000,
"logmass" = data.spp$logmass,
"carnivory" = data.spp$carn*100,   # put carnivory as a percentage
"carn_std" = data.spp$carn.std
)
# Orders of increasing body mass and carnivory, for plotting purposes
data_phi1_3 <- data_phi1_3 %>% arrange(logmass)
data_phi1_3$order_mass <- as.factor(c(1:nrow(data_phi1_3)))
data_phi1_3 <- data_phi1_3 %>% arrange(carnivory,logmass)
data_phi1_3$order.carn <- as.factor(c(1:nrow(data_phi1_3)))
data_phi1_3$fact.carn <- as.factor(round(data_phi1_3 %>% pull(carnivory), digits = 2))
data_phi1_3 <- data_phi1_3 %>% arrange(species)
###### Plot Urbanization-Occupancy Relationships vs. Traits ######
# Body Mass
# drop the rarely detected species and sort by mass
data.plot.spp <- data_phi1_3 %>%
arrange(mass) %>%
filter(!species %in% c("black_bear", "cougar", "flying_squirrel_sp", "hooded_skunk", "mountain beaver","north_american_beaver", "richardson_ground_squirrel", "weasel_sp")) # exclude rarely detected species from plot
plot.mass2 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.urbocc, aes(x = logmass, y = bm_med, ymin = bm_lower95, ymax = bm_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.urbocc, aes(x = logmass, y = bm_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = logmass, y = phi1, ymin = phi1_lower95, ymax = phi1_upper95),
color = "grey30") +
labs(x = "Body Mass (kg)", y = "Occupancy-Urbanization \nRelationship") +
scale_x_continuous(trans = "log10", breaks = log10(c(0.1, 1, 10, 100, 500)*1000), labels = c("0.1","1", "10", "100","500")) +
theme(
#axis.text.x = element_blank(),
#axis.text.y = element_blank(),
#axis.ticks = element_blank(),
axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.mass2
ggsave("./figures/Figure3a_speciesurbanrelationship_vs_mass.png",
plot.mass2,
width = 6,
height = 4,
units = "in",
dpi = 300)
# Carnivory
# drop the rarely detected species and sort by carnivory
data.plot.spp <- data_phi1_3 %>%
arrange(mass) %>%
filter(!species %in% c("black_bear", "cougar", "flying_squirrel_sp", "hooded_skunk", "mountain beaver","north_american_beaver", "richardson_ground_squirrel", "weasel_sp")) # exclude rarely detected species from plot
plot.carn2 <- ggplot() +
theme_classic()+
geom_ribbon(data = data.pred.urbocc, aes(x = carnivory*100+0.001, y = ca_med, ymin = ca_lower95, ymax = ca_upper95),
fill = "grey30", alpha = 0.2)+
geom_smooth(data = data.pred.urbocc, aes(x = carnivory*100+0.001, y = ca_med),
se = FALSE, color = "grey30") +
geom_pointrange(data = data.plot.spp, aes(x = carnivory+0.001, y = phi1, ymin = phi1_lower95, ymax = phi1_upper95, group = species),
color = "grey30", position = position_dodge(width = 2)) +
labs(x = "Carnivory (% Vertebrate Diet)", y = "Occupancy-Urbanization \nRelationship") +
theme(
#axis.text.x = element_blank(),
#axis.text.y = element_blank(),
#axis.ticks = element_blank(),
legend.position = "none",
axis.text.x = element_text(face = "bold", size = 14),
axis.text.y = element_text(face = "bold", size = 14),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.carn2
ggsave("./figures/Figure3b_speciesurbanrelationship_vs_carnivory.png",
plot.mass2,
width = 6,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/Figure3b_speciesurbanrelationship_vs_carnivory.png",
plot.carn2,
width = 6,
height = 4,
units = "in",
dpi = 300)
